{"version":3,"sources":["components/Uploader.js","components/Tips.js","pages/Home.js"],"names":["Dragger","Upload","Result","styled","div","H1","h1","Image","img","Component","observer","useStores","ImageStore","UserStore","ref1","useRef","ref2","store","useLocalStore","width","setWidth","height","setHeight","serverFile","attributes","url","widthStr","heightStr","props","showUploadList","beforeUpload","file","setFile","setFilename","name","currentUser","message","warning","size","error","window","test","type","upload","then","console","log","catch","tip","spinning","isUpoading","className","InboxOutlined","target","href","filename","src","ref","onChange","current","value","placeholder","fullStr","Tips","children","Home","Uploader"],"mappings":"giBAOQA,EAAYC,IAAZD,QAGFE,EAASC,IAAOC,IAAV,KAKNC,EAAKF,IAAOG,GAAV,KAIFC,EAAQJ,IAAOK,IAAV,KA6GIC,EAvGGC,aAAS,WAAO,IAAD,EACGC,cAA1BC,EADuB,EACvBA,WAAYC,EADW,EACXA,UACdC,EAAOC,mBACPC,EAAOD,mBAEPE,EAAQC,aAAc,iBAAO,CACjCC,MAAO,KACPC,SAFiC,SAExBD,GACPF,EAAME,MAAQA,GAEhB,eACE,OAAOF,EAAME,MAAN,aAAoBF,EAAME,OAAU,IAE7CE,OAAQ,KACRC,UATiC,SASvBD,GACRJ,EAAMI,OAASA,GAEjB,gBACE,OAAOJ,EAAMI,OAAN,aAAqBJ,EAAMI,QAAW,IAE/C,cACE,OAAOT,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,IAAM,gBAAkBR,EAAMS,SAAWT,EAAMU,eAapGC,EAAQ,CACZC,gBAAgB,EAChBC,aAAc,SAAAC,GAGZ,OAFAnB,EAAWoB,QAAQD,GACnBnB,EAAWqB,YAAYF,EAAKG,MACE,OAA1BrB,EAAUsB,aACZC,IAAQC,QAAQ,iEACT,IAELN,EAAKO,KAAO,SACdF,IAAQG,MAAM,wHAEhBC,OAAOT,KAAOA,EACT,uCAAuCU,KAAKV,EAAKW,OAItD9B,EAAW+B,SACNC,MAAK,SAACrB,GACLsB,QAAQC,IAAIvB,MACXwB,OAAM,gBAEN,IARLX,IAAQG,MAAM,sFACP,MAWb,OACI,6BACE,kBAAC,IAAD,CAAMS,IAAI,oCAAWC,SAAUrC,EAAWsC,YACxC,kBAAClD,EAAY4B,EACX,uBAAGuB,UAAU,wBACX,kBAACC,EAAA,EAAD,OAEF,uBAAGD,UAAU,mBAAb,wFACA,uBAAGA,UAAU,mBAAb,0MAOFvC,EAAWW,WAAa,kBAACrB,EAAD,KACtB,kBAACG,EAAD,iCACA,4BACE,yDACA,4BAAI,uBAAGgD,OAAO,SACPC,KAAM1C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,KAAMb,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,MAEnH,mDACA,4BAAKb,EAAW2C,UAChB,yDACA,4BACE,kBAAChD,EAAD,CAAOiD,IAAK5C,EAAWW,WAAWC,WAAWC,IAAID,WAAWC,OAE9D,8DACA,4BACE,2BAAOgC,IAAK3C,EAAM4C,SAhER,WACtBzC,EAAMG,SAASN,EAAK6C,QAAQC,QA+D6BC,YAAY,qDACzD,2BAAOJ,IAAKzC,EAAM0C,SA7DP,WACvBzC,EAAMK,UAAUN,EAAK2C,QAAQC,QA4D6BC,YAAY,sDAE5D,4BACE,uBAAGR,OAAO,SAASC,KAAMrC,EAAM6C,SAAU7C,EAAM6C,YAGzC,KAEd,oR,qKCvHR,IAAMC,EAAO5D,IAAOC,IAAV,KAoBKK,EAZGC,aAAS,YAAiB,IAAfsD,EAAc,EAAdA,SACpBnD,EAAaF,cAAbE,UACP,OACI,oCAEIA,EAAUsB,YAAc,KAAO,kBAAC4B,EAAD,KAAOC,OCZ1CC,EAAOvD,aAAS,WACAC,cAAbE,UACP,OACI,oCACE,kBAAC,EAAD,uFACA,kBAACqD,EAAD,UAKOD","file":"static/js/10.4ae26819.chunk.js","sourcesContent":["import React, { useRef } from 'react';\r\nimport { useStores } from '../stores';\r\nimport { observer, useLocalStore } from 'mobx-react';\r\nimport { Upload, message, Spin } from 'antd';\r\nimport { InboxOutlined } from '@ant-design/icons';\r\nimport styled from 'styled-components';\r\n\r\nconst { Dragger } = Upload;\r\n\r\n\r\nconst Result = styled.div`\r\n  margin-top: 30px;\r\n  border: 1px dashed #ccc;\r\n  padding: 20px;\r\n`;\r\nconst H1 = styled.h1`\r\n  margin: 20px 0;\r\n  text-align: center;\r\n`;\r\nconst Image = styled.img`\r\n  max-width: 300px;\r\n`;\r\n\r\n\r\n\r\nconst Component = observer(() => {\r\n  const { ImageStore, UserStore } = useStores();\r\n  const ref1 = useRef();\r\n  const ref2 = useRef();\r\n\r\n  const store = useLocalStore(() => ({\r\n    width: null,\r\n    setWidth(width) {\r\n      store.width = width;\r\n    },\r\n    get widthStr() {\r\n      return store.width ? `/w/${store.width}` : '';\r\n    },\r\n    height: null,\r\n    setHeight(height) {\r\n      store.height = height;\r\n    },\r\n    get heightStr() {\r\n      return store.height ? `/h/${store.height}` : '';\r\n    },\r\n    get fullStr() {\r\n      return ImageStore.serverFile.attributes.url.attributes.url + '?imageView2/0' + store.widthStr + store.heightStr\r\n    }\r\n\r\n  }));\r\n\r\n  const bindWidthChange = () => {\r\n    store.setWidth(ref1.current.value);\r\n  };\r\n\r\n  const bindHeightChange = () => {\r\n    store.setHeight(ref2.current.value);\r\n  };\r\n\r\n  const props = {\r\n    showUploadList: false,\r\n    beforeUpload: file => {\r\n      ImageStore.setFile(file);\r\n      ImageStore.setFilename(file.name);\r\n      if (UserStore.currentUser === null) {\r\n        message.warning('请先验证身份再上传！');\r\n        return false;\r\n      }\r\n      if (file.size > 4096 * 2160) {\r\n        message.error('为了缓解服务器压力，目前仅支持最大8M大小')\r\n      }\r\n      window.file = file\r\n      if (!/(svg$)|(png$)|(jpg$)|(jpeg$)|(gif)/ig.test(file.type)) {\r\n        message.error('现仅支持上传png/svg/jpg/gif格式的图片')\r\n        return false\r\n      }\r\n      ImageStore.upload()\r\n          .then((serverFile) => {\r\n            console.log(serverFile);\r\n          }).catch(() => {\r\n      });\r\n      return false;\r\n    }\r\n  };\r\n\r\n  return (\r\n      <div>\r\n        <Spin tip=\"图片上传中...\" spinning={ImageStore.isUpoading}>\r\n          <Dragger {...props}>\r\n            <p className=\"ant-upload-drag-icon\">\r\n              <InboxOutlined/>\r\n            </p>\r\n            <p className=\"ant-upload-text\">可以点击或者或者拖拽上传图片</p>\r\n            <p className=\"ant-upload-hint\">\r\n              目前仅支持.png/.gif/.jpg/.svg类型图片，为了缓解服务器压力单张图片大小不得超过8MB\r\n            </p>\r\n          </Dragger>\r\n        </Spin>\r\n\r\n        {\r\n          ImageStore.serverFile ? <Result>\r\n            <H1>上传结果</H1>\r\n            <dl>\r\n              <dt>线上地址:</dt>\r\n              <dd><a target=\"_blank\"\r\n                     href={ImageStore.serverFile.attributes.url.attributes.url}>{ImageStore.serverFile.attributes.url.attributes.url}</a>\r\n              </dd>\r\n              <dt>文件名:</dt>\r\n              <dd>{ImageStore.filename}</dd>\r\n              <dt>图片预览:</dt>\r\n              <dd>\r\n                <Image src={ImageStore.serverFile.attributes.url.attributes.url}/>\r\n              </dd>\r\n              <dt>自定义尺寸</dt>\r\n              <dd>\r\n                <input ref={ref1} onChange={bindWidthChange} placeholder=\"最大宽度（可选）\"/>\r\n                <input ref={ref2} onChange={bindHeightChange} placeholder=\"最大高度（可选）\"/>\r\n              </dd>\r\n              <dd>\r\n                <a target=\"_blank\" href={store.fullStr}>{store.fullStr}</a>\r\n              </dd>\r\n            </dl>\r\n          </Result> : null\r\n        }\r\n        <h3>本站可以将图片生成在线地址，并且无压缩源文件生成，方便你在任何地方使用你的图片！</h3>\r\n      </div>\r\n  );\r\n});\r\nexport default Component;","import React from 'react'\r\nimport {useStores} from \"../stores\";\r\nimport {observer} from \"mobx-react\";\r\nimport styled from \"styled-components\";\r\n\r\nconst Tips = styled.div`\r\n  background:orange;\r\n  padding:10px;\r\n  margin:30px 0;\r\n  color:#fff;\r\n  border-radius:6px;\r\n`\r\n\r\nconst Component = observer(({children}) => {\r\n  const {UserStore} = useStores()\r\n  return (\r\n      <>\r\n        {\r\n          UserStore.currentUser ? null : <Tips>{children}</Tips>\r\n        }\r\n\r\n      </>\r\n  )\r\n})\r\n\r\nexport default Component;","import React from \"react\";\r\nimport {observer} from \"mobx-react\";\r\nimport {useStores} from \"../stores\";\r\nimport Uploader from '../components/Uploader'\r\nimport Tips from '../components/Tips'\r\n\r\nconst Home = observer(() => {\r\n  const {UserStore} = useStores()\r\n  return (\r\n      <>\r\n        <Tips>请先验证通行证再使用该功能</Tips>\r\n        <Uploader/>\r\n      </>\r\n  );\r\n})\r\n\r\nexport default Home;\r\n"],"sourceRoot":""}